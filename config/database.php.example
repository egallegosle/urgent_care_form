<?php
/**
 * Database Configuration File
 *
 * IMPORTANT:
 * 1. Copy this file to database.php
 * 2. Update with your GoDaddy MySQL credentials
 * 3. Never commit database.php to git (it's in .gitignore)
 */

// Database Connection Settings
define('DB_HOST', 'localhost');              // Change to your GoDaddy MySQL host
define('DB_USER', 'your_database_username'); // Your GoDaddy database username
define('DB_PASS', 'your_database_password'); // Your GoDaddy database password
define('DB_NAME', 'your_database_name');     // Your GoDaddy database name
define('DB_CHARSET', 'utf8mb4');

// Error Reporting (set to false in production)
define('DB_DEBUG', true);

/**
 * Get database connection
 * @return mysqli Database connection object
 */
function getDBConnection() {
    $conn = new mysqli(DB_HOST, DB_USER, DB_PASS, DB_NAME);

    // Check connection
    if ($conn->connect_error) {
        if (DB_DEBUG) {
            error_log("Database connection failed: " . $conn->connect_error);
            die("Connection failed: " . $conn->connect_error);
        } else {
            error_log("Database connection failed: " . $conn->connect_error);
            die("Connection failed. Please try again later.");
        }
    }

    // Set charset
    if (!$conn->set_charset(DB_CHARSET)) {
        error_log("Error setting charset: " . $conn->error);
    }

    return $conn;
}

/**
 * Execute prepared statement safely
 * @param mysqli $conn Database connection
 * @param string $sql SQL query with placeholders
 * @param string $types Parameter types (e.g., "ssi" for string, string, int)
 * @param array $params Parameters to bind
 * @return mysqli_stmt|false Prepared statement or false on error
 */
function executePreparedStatement($conn, $sql, $types, $params) {
    $stmt = $conn->prepare($sql);

    if (!$stmt) {
        error_log("Prepare failed: " . $conn->error);
        return false;
    }

    if (!empty($params)) {
        $stmt->bind_param($types, ...$params);
    }

    if (!$stmt->execute()) {
        error_log("Execute failed: " . $stmt->error);
        return false;
    }

    return $stmt;
}

/**
 * Sanitize input data
 * @param string $data Input data
 * @return string Sanitized data
 */
function sanitizeInput($data) {
    $data = trim($data);
    $data = stripslashes($data);
    $data = htmlspecialchars($data, ENT_QUOTES, 'UTF-8');
    return $data;
}

/**
 * Close database connection
 * @param mysqli $conn Database connection
 */
function closeDBConnection($conn) {
    if ($conn) {
        $conn->close();
    }
}
?>
